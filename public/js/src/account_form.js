// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('rdio-sync', ['ngRoute', 'ngResource']).factory('socket', function($rootScope) {
    var socket;
    socket = io.connect('http://localhost:3003');
    return {
      on: function(eventName, callback) {
        return socket.on(eventName, function() {
          var args;
          args = arguments;
          return $rootScope.$apply(function() {
            return callback.apply(socket, args);
          });
        });
      },
      emit: function(eventName, data, callback) {
        return socket.emit(eventName, data, function() {
          var args;
          args = arguments;
          return $rootScope.$apply(function() {
            return callback != null ? callback.apply(socket, args) : void 0;
          });
        });
      }
    };
  }).config(function($locationProvider, $routeProvider) {
    $locationProvider.html5Mode(true);
    return $routeProvider.when('/', {
      templateUrl: '/landing.html'
    }).when('/accounts/:id', {
      controller: 'AcountsController',
      templateUrl: '/account.html'
    }).otherwise({
      redirectTo: '/'
    });
  }).controller('AcountsController', function($scope, $resource, $routeParams, socket) {
    var Account;
    Account = $resource('/api/v1/accounts/:id', {
      id: '@id'
    }, {
      update: {
        method: 'PUT',
        isArray: false
      }
    });
    $scope.loading = true;
    $scope.account = Account.get({
      id: $routeParams.id
    }, function() {
      return $scope.loading = false;
    });
    $scope.messages = {
      'save:start': 'Saving account.',
      'unset_all_synced_tracks:start': 'Unsetting all synced tracks.',
      'set_tracks_to_sync:start': 'Setting tracks to sync.'
    };
    socket.on('account:update', function(data) {
      if (data.id === $scope.account.id) {
        return $scope.account.status = data.status;
      }
    });
    $scope.syncAccount = function() {
      $scope.loading = true;
      $scope.account.sync_now = true;
      return $scope.account.$update(function() {
        $scope.loading = false;
        return $scope.account.sync_now = false;
      });
    };
    return $scope.updateAccount = function() {
      $scope.loading = true;
      return $scope.account.$update(function() {
        return $scope.loading = false;
      });
    };
  });

}).call(this);

//# sourceMappingURL=account_form.map
